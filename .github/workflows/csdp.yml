name: test CSDP
on: push

jobs:
  csdp:
    runs-on: ubuntu-24.04
    steps:
      - name: Install CSDP
        run: sudo apt install -y coinor-csdp
      - name: Create CSDP input files
        run: |
          cat << EOF > test-1.dat-s
          *SDPA file generated by SemidefiniteProgramming.m2
          1 =mdim
          1 =nblocks
          3
          -.7071067811865475
          0 1 1 1 -8
          0 1 1 3 4
          0 1 2 2 -2
          0 1 2 3 2.718281828459045
          0 1 3 3 -8.389056098930649
          1 1 1 1 -.7071067811865475
          EOF
          cat << EOF > test-2.dat-s
          *SDPA file generated by SemidefiniteProgramming.m2
          1 =mdim
          1 =nblocks
          3
          -.7071067811865475
          0 1 1 1 -7.999999999999996
          0 1 1 3 4
          0 1 2 2 -2
          0 1 2 3 2.718281828459045
          0 1 3 3 -8.389056098930649
          1 1 1 1 -.7071067811865475
          EOF
      - name: Run CSDP
        run: |
          csdp test-1.dat-s test-1.out
          echo $?
          cat test-1.out
          csdp test-2.dat-s test-2.out
          echo $?
          cat test-2.out
